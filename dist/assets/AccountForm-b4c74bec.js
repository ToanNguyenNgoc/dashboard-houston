import{a5 as ee,j as l,ae,af as le,ag as J,ah as n,ai as k,aj as x,r as h,ak as oe,al as re,am as se,an as W,ao as S,c as t,ap as ce,w as L,q as B,aq as ie,A as te,B as ne,a3 as de,s as pe,F as ue,P as me,C as fe,y as H,x as Q}from"./index-97d1d3fe.js";import{u as X}from"./useQuery-beab7f21.js";import{r as ve,i as be,a as Ce}from"./jsx-runtime_commonjs-proxy-4ae2505d.js";import{B as ge}from"./index-ecc8aed2.js";const he=ee(l("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");function ye(e){return le("MuiChip",e)}const $e=ae("MuiChip",["root","sizeSmall","sizeMedium","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]),i=$e,_e=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant","tabIndex","skipFocusWhenDisabled"],Ne=e=>{const{classes:a,disabled:u,size:s,color:r,iconColor:C,onDelete:v,clickable:m,variant:p}=e,$={root:["root",p,u&&"disabled",`size${n(s)}`,`color${n(r)}`,m&&"clickable",m&&`clickableColor${n(r)}`,v&&"deletable",v&&`deletableColor${n(r)}`,`${p}${n(r)}`],label:["label",`label${n(s)}`],avatar:["avatar",`avatar${n(s)}`,`avatarColor${n(r)}`],icon:["icon",`icon${n(s)}`,`iconColor${n(C)}`],deleteIcon:["deleteIcon",`deleteIcon${n(s)}`,`deleteIconColor${n(r)}`,`deleteIcon${n(p)}Color${n(r)}`]};return ce($,ye,a)},ke=J("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:u}=e,{color:s,iconColor:r,clickable:C,onDelete:v,size:m,variant:p}=u;return[{[`& .${i.avatar}`]:a.avatar},{[`& .${i.avatar}`]:a[`avatar${n(m)}`]},{[`& .${i.avatar}`]:a[`avatarColor${n(s)}`]},{[`& .${i.icon}`]:a.icon},{[`& .${i.icon}`]:a[`icon${n(m)}`]},{[`& .${i.icon}`]:a[`iconColor${n(r)}`]},{[`& .${i.deleteIcon}`]:a.deleteIcon},{[`& .${i.deleteIcon}`]:a[`deleteIcon${n(m)}`]},{[`& .${i.deleteIcon}`]:a[`deleteIconColor${n(s)}`]},{[`& .${i.deleteIcon}`]:a[`deleteIcon${n(p)}Color${n(s)}`]},a.root,a[`size${n(m)}`],a[`color${n(s)}`],C&&a.clickable,C&&s!=="default"&&a[`clickableColor${n(s)})`],v&&a.deletable,v&&s!=="default"&&a[`deletableColor${n(s)}`],a[p],a[`${p}${n(s)}`]]}})(({theme:e,ownerState:a})=>{const u=k(e.palette.text.primary,.26),s=e.palette.mode==="light"?e.palette.grey[700]:e.palette.grey[300];return x({maxWidth:"100%",fontFamily:e.typography.fontFamily,fontSize:e.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:(e.vars||e).palette.text.primary,backgroundColor:(e.vars||e).palette.action.selected,borderRadius:32/2,whiteSpace:"nowrap",transition:e.transitions.create(["background-color","box-shadow"]),cursor:"default",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${i.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${i.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:e.vars?e.vars.palette.Chip.defaultAvatarColor:s,fontSize:e.typography.pxToRem(12)},[`& .${i.avatarColorPrimary}`]:{color:(e.vars||e).palette.primary.contrastText,backgroundColor:(e.vars||e).palette.primary.dark},[`& .${i.avatarColorSecondary}`]:{color:(e.vars||e).palette.secondary.contrastText,backgroundColor:(e.vars||e).palette.secondary.dark},[`& .${i.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:e.typography.pxToRem(10)},[`& .${i.icon}`]:x({marginLeft:5,marginRight:-6},a.size==="small"&&{fontSize:18,marginLeft:4,marginRight:-4},a.iconColor===a.color&&x({color:e.vars?e.vars.palette.Chip.defaultIconColor:s},a.color!=="default"&&{color:"inherit"})),[`& .${i.deleteIcon}`]:x({WebkitTapHighlightColor:"transparent",color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.26)`:u,fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.4)`:k(u,.4)}},a.size==="small"&&{fontSize:16,marginRight:4,marginLeft:-4},a.color!=="default"&&{color:e.vars?`rgba(${e.vars.palette[a.color].contrastTextChannel} / 0.7)`:k(e.palette[a.color].contrastText,.7),"&:hover, &:active":{color:(e.vars||e).palette[a.color].contrastText}})},a.size==="small"&&{height:24},a.color!=="default"&&{backgroundColor:(e.vars||e).palette[a.color].main,color:(e.vars||e).palette[a.color].contrastText},a.onDelete&&{[`&.${i.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:k(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},a.onDelete&&a.color!=="default"&&{[`&.${i.focusVisible}`]:{backgroundColor:(e.vars||e).palette[a.color].dark}})},({theme:e,ownerState:a})=>x({},a.clickable&&{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:k(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity)},[`&.${i.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.action.selectedChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:k(e.palette.action.selected,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)},"&:active":{boxShadow:(e.vars||e).shadows[1]}},a.clickable&&a.color!=="default"&&{[`&:hover, &.${i.focusVisible}`]:{backgroundColor:(e.vars||e).palette[a.color].dark}}),({theme:e,ownerState:a})=>x({},a.variant==="outlined"&&{backgroundColor:"transparent",border:e.vars?`1px solid ${e.vars.palette.Chip.defaultBorder}`:`1px solid ${e.palette.mode==="light"?e.palette.grey[400]:e.palette.grey[700]}`,[`&.${i.clickable}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${i.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`& .${i.avatar}`]:{marginLeft:4},[`& .${i.avatarSmall}`]:{marginLeft:2},[`& .${i.icon}`]:{marginLeft:4},[`& .${i.iconSmall}`]:{marginLeft:2},[`& .${i.deleteIcon}`]:{marginRight:5},[`& .${i.deleteIconSmall}`]:{marginRight:3}},a.variant==="outlined"&&a.color!=="default"&&{color:(e.vars||e).palette[a.color].main,border:`1px solid ${e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / 0.7)`:k(e.palette[a.color].main,.7)}`,[`&.${i.clickable}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:k(e.palette[a.color].main,e.palette.action.hoverOpacity)},[`&.${i.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / ${e.vars.palette.action.focusOpacity})`:k(e.palette[a.color].main,e.palette.action.focusOpacity)},[`& .${i.deleteIcon}`]:{color:e.vars?`rgba(${e.vars.palette[a.color].mainChannel} / 0.7)`:k(e.palette[a.color].main,.7),"&:hover, &:active":{color:(e.vars||e).palette[a.color].main}}})),xe=J("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,a)=>{const{ownerState:u}=e,{size:s}=u;return[a.label,a[`label${n(s)}`]]}})(({ownerState:e})=>x({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},e.size==="small"&&{paddingLeft:8,paddingRight:8}));function G(e){return e.key==="Backspace"||e.key==="Delete"}const Ie=h.forwardRef(function(a,u){const s=oe({props:a,name:"MuiChip"}),{avatar:r,className:C,clickable:v,color:m="default",component:p,deleteIcon:$,disabled:g=!1,icon:_,label:c,onClick:N,onDelete:f,onKeyDown:z,onKeyUp:y,size:T="medium",variant:P="filled",tabIndex:F,skipFocusWhenDisabled:q=!1}=s,O=re(s,_e),d=h.useRef(null),o=se(d,u),I=b=>{b.stopPropagation(),f&&f(b)},D=b=>{b.currentTarget===b.target&&G(b)&&b.preventDefault(),z&&z(b)},E=b=>{b.currentTarget===b.target&&(f&&G(b)?f(b):b.key==="Escape"&&d.current&&d.current.blur()),y&&y(b)},V=v!==!1&&N?!0:v,w=V||f?W:p||"div",M=x({},s,{component:w,disabled:g,size:T,color:m,iconColor:h.isValidElement(_)&&_.props.color||m,onDelete:!!f,clickable:V,variant:P}),R=Ne(M),Z=w===W?x({component:p||"div",focusVisibleClassName:R.focusVisible},f&&{disableRipple:!0}):{};let K=null;f&&(K=$&&h.isValidElement($)?h.cloneElement($,{className:S($.props.className,R.deleteIcon),onClick:I}):l(he,{className:S(R.deleteIcon),onClick:I}));let A=null;r&&h.isValidElement(r)&&(A=h.cloneElement(r,{className:S(R.avatar,r.props.className)}));let j=null;return _&&h.isValidElement(_)&&(j=h.cloneElement(_,{className:S(R.icon,_.props.className)})),t(ke,x({as:w,className:S(R.root,C),disabled:V&&g?!0:void 0,onClick:N,onKeyDown:D,onKeyUp:E,ref:o,tabIndex:q&&g?-1:F,ownerState:M},Z,O,{children:[A||j,l(xe,{className:S(R.label),ownerState:M,children:c}),K]}))}),Re=Ie;var U={},Se=be;Object.defineProperty(U,"__esModule",{value:!0});var Y=U.default=void 0,Pe=Se(ve()),ze=Ce,qe=(0,Pe.default)((0,ze.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle");Y=U.default=qe;function Oe(e){var g,_;const{value:a,setValue:u}=e,s=h.useRef(null),{data:r}=X({queryKey:["SELECT_ROLE"],queryFn:()=>L.roles({is_super_admin:!1}),refetchOnWindowFocus:!1}),C=c=>{u&&u(N=>N.includes(c)?N.filter(f=>f!==c):[...N,c])},v=c=>{u&&u(N=>N.filter(f=>f!==c))};let m=[];for(var p=0;p<((g=r==null?void 0:r.data)==null?void 0:g.length);p++)a!=null&&a.includes((_=r==null?void 0:r.data[p])==null?void 0:_.id)&&m.push(r==null?void 0:r.data[p]);const $=()=>{var c;(c=s.current)==null||c.classList.add("role_select_show")};return window.addEventListener("click",()=>{var c;return(c=s.current)==null?void 0:c.classList.remove("role_select_show")}),t("div",{className:"role_cnt",children:[l("div",{onClick:c=>{$(),c.stopPropagation()},className:"form-control form-control-solid",children:m.map(c=>l(Re,{label:c.title,onDelete:()=>v(c.id),size:"medium",color:"primary"},c.id))}),l("div",{ref:s,onClick:c=>c.stopPropagation(),className:"role_select",children:l("ul",{className:"role_list",children:r==null?void 0:r.data.map(c=>l("li",{className:"role_item",children:l(B,{onClick:()=>C(c.id),variant:"text",title:c.title,color:"inherit",size:"large",style:a!=null&&a.includes(c.id)?{backgroundColor:"var(--kt-gray-300)"}:{}})},c.id))})})]})}function Ee(){var q,O;const e=ie(),{branch:a}=h.useContext(te),[u]=ne(d=>[d.isSPA]),s=e.id,[r,C]=h.useState({fullname:"",full_address:"",status:!0,sex:!0}),[v,m]=h.useState([]),[p,$]=h.useState(a==null?void 0:a.id),{register:g,handleSubmit:_,setValue:c}=de(),{handle:N,result:f,onCloseNoti:z}=pe(),{data:y,refetch:T}=X({queryKey:["FORM_ACCOUNT",s],queryFn:()=>L.accountById(s),enabled:!!s,refetchOnWindowFocus:!1,onSuccess(d){var I,D;const o=d.data;C({fullname:o==null?void 0:o.fullname,full_address:o==null?void 0:o.full_address,status:o==null?void 0:o.status,sex:o==null?void 0:o.sex}),m((I=o==null?void 0:o.roles)==null?void 0:I.map(E=>E.id)),$((D=o==null?void 0:o.branch)==null?void 0:D.id),c("fullname",o==null?void 0:o.fullname),c("telephone",o==null?void 0:o.telephone),c("email",o==null?void 0:o.email),c("password",o==null?void 0:o.password),c("description",o==null?void 0:o.description),c("full_address",o==null?void 0:o.full_address),c("ccid",o.ccid)}});let P="POST";s&&(y!=null&&y.data)&&(P="PUT");const F=async d=>{var o;if(v.length>0&&(P==="POST"&&await N({handleFn:()=>L.postAccount({...d,sex:r.sex,roles:v,branch_id:p}),messageSuccess:"Create account success !"}),P==="PUT")){const I={...d,telephone:d.telephone!==((o=y==null?void 0:y.data)==null?void 0:o.telephone)?d.telephone:null,roles:v,branch_id:p};await N({handleFn:()=>L.putAccount(s,{...Q.pickBy(I,Q.identity),sex:r.sex,status:r.status}),messageSuccess:"Update account success !"})}};return t(ue,{children:[l(me,{children:"Create new account"}),l(fe,{open:f.open,onClose:z,message:f.message,severity:f.messageColor}),t("div",{className:"card card_cnt",children:[t("div",{className:"account_head",children:[l("div",{className:"account_head-avatar",children:t("div",{className:"avatar_cnt",children:[l("img",{src:((O=(q=y==null?void 0:y.data)==null?void 0:q.media)==null?void 0:O.original_url)??"",alt:""}),r.status&&l("div",{className:"avatar_cnt-act",children:l(Y,{color:"success"})})]})}),t("div",{className:"account_head-info",children:[l("p",{className:"acc_fullname",children:r.fullname}),l("p",{className:"acc_address",children:r.full_address})]})]}),t("div",{className:"account_form",children:[l("span",{className:"title",children:"Information"}),t("form",{onSubmit:_(F),className:"form",children:[t("div",{className:"form_body",children:[t("div",{className:"form_row",children:[t("div",{className:"form_column",children:[l("label",{className:"form-label required",children:"Fullname"}),l("input",{type:"text",...g("fullname",{required:!0}),onChange:d=>C({...r,fullname:d.target.value}),className:"form-control form-control-solid"})]}),t("div",{className:"form_column",children:[l("label",{className:"form-label required",children:"Telephone"}),l("input",{type:"text",...g("telephone",{required:!0}),className:"form-control form-control-solid"})]})]}),l("div",{className:"form_row",children:t("div",{className:"form_column",children:[l("label",{className:"form-label required",children:"CCID"}),l("input",{type:"text",...g("ccid",{required:!0}),className:"form-control form-control-solid"})]})}),t("div",{className:"form_row",children:[t("div",{className:"form_column form_column_status",children:[l("label",{className:"form-label required",children:"Email"}),l("input",{...g("email",{required:!0}),type:"text",disabled:s,className:"form-control form-control-solid"})]}),t("div",{className:"form_column form_column_control",children:[t("div",{className:"item",children:[l("label",{className:"form-label required",children:"Status"}),l(H,{checked:r.status,onChange:d=>C({...r,status:d.target.checked})})]}),t("div",{className:"item",children:[l("label",{className:"form-label required",children:"Sex"}),l(H,{checked:r.sex,onChange:d=>C({...r,sex:d.target.checked})})]})]})]}),!y&&t("div",{className:"form_row",children:[t("div",{className:"form_column",children:[l("label",{className:"form-label required",children:"Password"}),l("input",{...g("password",{required:!0}),type:"text",className:"form-control form-control-solid"})]}),t("div",{className:"form_column",children:[l("label",{className:"form-label required",children:"Confirm password"}),l("input",{type:"text",className:"form-control form-control-solid"})]})]}),l("div",{className:"form_row",children:t("div",{className:"form_column_1",children:[l("label",{className:"form-label required",children:"Description"}),l("input",{...g("description"),type:"text",className:"form-control form-control-solid"})]})}),l("div",{className:"form_row",children:t("div",{className:"form_column_1",children:[l("label",{className:"form-label required",children:"Full address"}),l("input",{type:"text",className:"form-control form-control-solid",...g("full_address",{required:!0}),onChange:d=>C({...r,full_address:d.target.value})})]})}),t("div",{className:"form_row",children:[t("div",{className:"form_column",children:[l("label",{className:"form-label required",children:"Roles"}),l(Oe,{value:v,setValue:m})]}),t("div",{className:"form_column form_column_branch",children:[l("label",{className:"form-label required",children:"Branch"}),l(ge,{branchId:p,setBranchId:$}),!u&&l("div",{className:"form_column_branch_dis"})]})]})]}),t("div",{className:"form_bottom",children:[l("div",{className:"form_bottom_btn",children:l(B,{size:"large",title:"Save",color:"success",type:"submit",load:f.load})}),l("div",{className:"form_bottom_btn",children:l(B,{size:"large",title:"Restore",color:"inherit",variant:"outlined",type:"submit",onClick:T})})]})]})]})]})]})}export{Ee as default};
