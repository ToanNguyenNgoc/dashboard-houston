import{a5 as z,j as e,ae as U,af as j,ag as E,ar as H,as as T,ah as O,aj as N,ai as V,r as x,ak as D,al as W,ao as K,ap as Q,w as I,F as _,c as r,aq as A,s as J,a3 as X,P as Y,C as Z,q as B,y as G}from"./index-c922f188.js";import{u as M}from"./useQuery-31964acc.js";function ee(s){let t=[];for(var o=0;o<(s==null?void 0:s.length);o++)t.indexOf(s[o])===-1&&t.push(s[o]);return t}const se=z(e("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),te=z(e("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),ae=z(e("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function oe(s){return j("MuiCheckbox",s)}const ce=U("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary"]),F=ce,ne=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],ie=s=>{const{classes:t,indeterminate:o,color:n}=s,l={root:["root",o&&"indeterminate",`color${O(n)}`]},i=Q(l,oe,t);return N({},t,i)},re=E(H,{shouldForwardProp:s=>T(s)||s==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:o}=s;return[t.root,o.indeterminate&&t.indeterminate,o.color!=="default"&&t[`color${O(o.color)}`]]}})(({theme:s,ownerState:t})=>N({color:(s.vars||s).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:s.vars?`rgba(${t.color==="default"?s.vars.palette.action.activeChannel:s.vars.palette.primary.mainChannel} / ${s.vars.palette.action.hoverOpacity})`:V(t.color==="default"?s.palette.action.active:s.palette[t.color].main,s.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.color!=="default"&&{[`&.${F.checked}, &.${F.indeterminate}`]:{color:(s.vars||s).palette[t.color].main},[`&.${F.disabled}`]:{color:(s.vars||s).palette.action.disabled}})),le=e(te,{}),de=e(se,{}),me=e(ae,{}),ue=x.forwardRef(function(t,o){var n,l;const i=D({props:t,name:"MuiCheckbox"}),{checkedIcon:f=le,color:C="primary",icon:p=de,indeterminate:a=!1,indeterminateIcon:c=me,inputProps:d,size:m="medium",className:u}=i,P=W(i,ne),y=a?c:p,g=a?c:f,S=N({},i,{color:C,indeterminate:a,size:m}),v=ie(S);return e(re,N({type:"checkbox",inputProps:N({"data-indeterminate":a},d),icon:x.cloneElement(y,{fontSize:(n=y.props.fontSize)!=null?n:m}),checkedIcon:x.cloneElement(g,{fontSize:(l=g.props.fontSize)!=null?l:m}),ownerState:S,ref:o,className:K(v.root,u)},P,{classes:v}))}),he=ue;function pe(s){var p;const{permissions:t,setPermissions:o}=s,{data:n}=M({queryKey:["PERMISSION_CPN"],queryFn:()=>I.permissions(),refetchOnWindowFocus:!1}),l=(p=n==null?void 0:n.data)==null?void 0:p.map(a=>{const c=a.permission_path.split(".")[1];return{...a,path:c}}),i=ee(l==null?void 0:l.map(a=>a.path)),f=i==null?void 0:i.map(a=>{const c=l.filter(d=>d.path===a);return{title:a,group:c}}),C=a=>{o&&o(c=>c.includes(a)?c.filter(d=>d!==a):[...c,a])};return e(_,{children:r("div",{className:"permission-cnt",children:[e("div",{className:"per-header",children:r("ul",{className:"list-item",children:[e("li",{className:"item",children:"Find all"}),e("li",{className:"item",children:"Create"}),e("li",{className:"item",children:"Find one"}),e("li",{className:"item",children:"Update"}),e("li",{className:"item",children:"Delete"})]})}),e("div",{className:"per-body",children:f==null?void 0:f.map((a,c)=>{var d;return r("div",{className:"per-body-item",children:[e("div",{className:"item-name",children:e("span",{children:a.title})}),e("ul",{className:"item-check-list",children:(d=a.group)==null?void 0:d.map(m=>r("li",{className:"item-check",children:[e(he,{checked:t==null?void 0:t.includes(m.id),onChange:()=>C(m.id),color:"success"}),e("div",{className:"item-hover",children:m.permission_path})]},m.id))})]},c)})})]})})}function ve(){var v;const t=A().id,{handle:o,result:n,onCloseNoti:l}=J(),{register:i,formState:f,handleSubmit:C,setValue:p}=X(),[a,c]=x.useState([]),[d,m]=x.useState(!0),{data:u,isFetching:P,refetch:y}=M({queryKey:["ROLE_ID",t],queryFn:()=>I.roleById(t),enabled:!!t,refetchOnWindowFocus:!1,onSuccess(h){var b,k,$,q,R,w;p("title",(b=h.data)==null?void 0:b.title),p("description",(k=h.data)==null?void 0:k.description),p("status",($=h.data)==null?void 0:$.status),m((q=h.data)==null?void 0:q.status),c((w=(R=h.data)==null?void 0:R.permissions)==null?void 0:w.map(L=>L.id))}}),g=h=>{m(h.target.checked)},S=async h=>{var k;const b={...h,permissions:a,status:d};u!=null&&u.data?await o({handleFn:()=>I.putRole(t,b),messageSuccess:`Update role ${(k=u==null?void 0:u.data)==null?void 0:k.title} success`}):await o({handleFn:()=>I.postRole(b),messageSuccess:"Create role success"})};return r(_,{children:[e(Y,{children:t?`Thay đổi quyền ${(v=u==null?void 0:u.data)==null?void 0:v.title}`:"Tạo quyền"}),e(Z,{onClose:l,open:n.open,message:n.message,severity:n.messageColor}),r("div",{className:"card ",children:[e("div",{className:"role-form-cnt",children:r("form",{onSubmit:C(S),className:"form",children:[r("div",{className:"form_head",children:[e(B,{title:"Save",size:"large",color:"success",type:"submit",load:n.load}),e(B,{title:"Restore",size:"large",variant:"outlined",color:"inherit",type:"button",onClick:y,style:{marginLeft:"8px"},load:P})]}),r("div",{className:"form_body",children:[r("div",{className:"form-row",children:[e("label",{className:"form-label required",children:"Name"}),e("input",{type:"text",...i("title",{required:!0}),className:"form-control form-control-solid"})]}),r("div",{className:"form-row",children:[e("label",{className:"form-label required",children:"Description"}),e("input",{...i("description",{required:!0}),type:"text",className:"form-control form-control-solid"})]}),r("div",{className:"form-row",children:[e("label",{className:"form-label required",children:"Status"}),e(G,{checked:d,onChange:g})]})]})]})}),e("div",{className:"card-body py-3",children:e(pe,{permissions:a,setPermissions:c})})]})]})}export{ve as default};
